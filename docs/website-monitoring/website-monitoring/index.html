<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.4">
<link rel="alternate" type="application/rss+xml" href="/big-documentation/blog/rss.xml" title="BIG Docs Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/big-documentation/blog/atom.xml" title="BIG Docs Blog Atom Feed"><title data-react-helmet="true">website-monitoring | BIG Docs</title><meta data-react-helmet="true" property="og:url" content="https://EmmettMartinBig.github.io/big-documentation/docs/website-monitoring/website-monitoring"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="website-monitoring | BIG Docs"><meta data-react-helmet="true" name="description" content="Step 1 ‚Äî Creating Service Users"><meta data-react-helmet="true" property="og:description" content="Step 1 ‚Äî Creating Service Users"><link data-react-helmet="true" rel="shortcut icon" href="/big-documentation/img/BigDigital-logo-black.png"><link data-react-helmet="true" rel="canonical" href="https://EmmettMartinBig.github.io/big-documentation/docs/website-monitoring/website-monitoring"><link data-react-helmet="true" rel="alternate" href="https://EmmettMartinBig.github.io/big-documentation/docs/website-monitoring/website-monitoring" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://EmmettMartinBig.github.io/big-documentation/docs/website-monitoring/website-monitoring" hreflang="x-default"><link rel="stylesheet" href="/big-documentation/assets/css/styles.d9bfc96a.css">
<link rel="preload" href="/big-documentation/assets/js/runtime~main.70c760db.js" as="script">
<link rel="preload" href="/big-documentation/assets/js/main.efc8312f.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/big-documentation/"><img src="/big-documentation/img/BigDigital-logo-black.png" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/big-documentation/img/BigDigital-logo-black.png" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">BIG Docs</b></a><a class="navbar__item navbar__link navbar__link--active" href="/big-documentation/docs/intro">Documentation</a><a class="navbar__item navbar__link" href="/big-documentation/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/EmmettMartinBig" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">üåú</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">üåû</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button" title="Scroll to top"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/big-documentation/docs/intro">Docs Intro</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Website Monitoring</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/big-documentation/docs/website-monitoring/blackbox-exporter">Black Box Exporter</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/big-documentation/docs/website-monitoring/website-monitoring">Prometheus Walkthrough from Digital Ocean</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/big-documentation/docs/website-monitoring/host-installer">Prometheus Installer (Server Installer)</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">AWS-EC2</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Ngrok</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Brightsign</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="markdown"><header><h1 class="h1Heading_27L5">website-monitoring</h1></header><p>Step 1 ‚Äî Creating Service Users</p><p>For security purposes, we‚Äôll begin by creating two new user accounts, prometheus and node_exporter. We‚Äôll use these accounts throughout the tutorial to isolate the ownership on Prometheus‚Äô core files and directories.</p><p>Create these two users, and use the --no-create-home and --shell /bin/false options so that these users can‚Äôt log into the server.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">sudo useradd --no-create-home --shell /bin/false prometheus</span></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo useradd --no-create-home --shell /bin/false node_exporter</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Before we download the Prometheus binaries, create the necessary directories for storing Prometheus‚Äô files and data. Following standard Linux conventions, we‚Äôll create a directory in /etc for Prometheus‚Äô configuration files and a directory in /var/lib for its data.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">sudo mkdir /etc/prometheus</span></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo mkdir /var/lib/prometheus</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Now, set the user and group ownership on the new directories to the prometheus user.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">sudo chown prometheus:prometheus /etc/prometheus</span></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo chown prometheus:prometheus /var/lib/prometheus</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>With our users and directories in place, we can now download Prometheus and then create the minimal configuration file to run Prometheus for the first time.
Step 2 ‚Äî Downloading Prometheus</p><p>First, download and unpack the current stable version of Prometheus into your home directory. You can find the latest binaries along with their checksums on the Prometheus download page.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">cd ~</span></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -LO https://github.com/prometheus/prometheus/releases/download/v2.0.0/prometheus-2.0.0.linux-amd64.tar.gz</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Next, use the sha256sum command to generate a checksum of the downloaded file:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">sha256sum prometheus-2.0.0.linux-amd64.tar.gz</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Compare the output from this command with the checksum on the Prometheus download page to ensure that your file is both genuine and not corrupted.</p><p>Output
e12917b25b32980daee0e9cf879d9ec197e2893924bd1574604eb0f550034d46  prometheus-2.0.0.linux-amd64.tar.gz</p><p>If the checksums don‚Äôt match, remove the downloaded file and repeat the preceding steps to re-download the file.</p><p>Now, unpack the downloaded archive.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">tar xvf prometheus-2.0.0.linux-amd64.tar.gz</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>This will create a directory called prometheus-2.0.0.linux-amd64 containing two binary files (prometheus and promtool), consoles and console_libraries directories containing the web interface files, a license, a notice, and several example files.</p><p>Copy the two binaries to the /usr/local/bin directory.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">sudo cp prometheus-2.0.0.linux-amd64/prometheus /usr/local/bin/</span></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo cp prometheus-2.0.0.linux-amd64/promtool /usr/local/bin/</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Set the user and group ownership on the binaries to the prometheus user created in Step 1.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">sudo chown prometheus:prometheus /usr/local/bin/prometheus</span></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo chown prometheus:prometheus /usr/local/bin/promtool</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Copy the consoles and console_libraries directories to /etc/prometheus.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">sudo cp -r prometheus-2.0.0.linux-amd64/consoles /etc/prometheus</span></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo cp -r prometheus-2.0.0.linux-amd64/console_libraries /etc/prometheus</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Set the user and group ownership on the directories to the prometheus user. Using the -R flag will ensure that ownership is set on the files inside the directory as well.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">sudo chown -R prometheus:prometheus /etc/prometheus/consoles</span></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo chown -R prometheus:prometheus /etc/prometheus/console_libraries</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Lastly, remove the leftover files from your home directory as they are no longer needed.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">rm -rf prometheus-2.0.0.linux-amd64.tar.gz prometheus-2.0.0.linux-amd64</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Now that Prometheus is installed, we‚Äôll create its configuration and service files in preparation of its first run.
Step 3 ‚Äî Configuring Prometheus</p><p>In the /etc/prometheus directory, use nano or your favorite text editor to create a configuration file named prometheus.yml. For now, this file will contain just enough information to run Prometheus for the first time.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">sudo nano /etc/prometheus/prometheus.yml</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Warning: Prometheus‚Äô configuration file uses the YAML format, which strictly forbids tabs and requires two spaces for indentation. Prometheus will fail to start if the configuration file is incorrectly formatted.</p><p>In the global settings, define the default interval for scraping metrics. Note that Prometheus will apply these settings to every exporter unless an individual exporter‚Äôs own settings override the globals.
Prometheus config file part 1 - /etc/prometheus/prometheus.yml</p><p>global:
scrape_interval: 15s</p><p>This scrape_interval value tells Prometheus to collect metrics from its exporters every 15 seconds, which is long enough for most exporters.</p><p>Now, add Prometheus itself to the list of exporters to scrape from with the following scrape_configs directive:
Prometheus config file part 2 - /etc/prometheus/prometheus.yml</p><p>...
scrape_configs:</p><ul><li>job_name: &#x27;prometheus&#x27;
scrape_interval: 5s
static_configs:<ul><li>targets: [&#x27;localhost:9090&#x27;]</li></ul></li></ul><p>Prometheus uses the job_name to label exporters in queries and on graphs, so be sure to pick something descriptive here.</p><p>And, as Prometheus exports important data about itself that you can use for monitoring performance and debugging, we‚Äôve overridden the global scrape_interval directive from 15 seconds to 5 seconds for more frequent updates.</p><p>Lastly, Prometheus uses the static_configs and targets directives to determine where exporters are running. Since this particular exporter is running on the same server as Prometheus itself, we can use localhost instead of an IP address along with the default port, 9090.</p><p>Your configuration file should now look like this:
Prometheus config file - /etc/prometheus/prometheus.yml</p><p>global:
scrape_interval: 15s</p><p>scrape_configs:</p><ul><li>job_name: &#x27;prometheus&#x27;
scrape_interval: 5s
static_configs:<ul><li>targets: [&#x27;localhost:9090&#x27;]</li></ul></li></ul><p>Save the file and exit your text editor.</p><p>Now, set the user and group ownership on the configuration file to the prometheus user created in Step 1.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">sudo chown prometheus:prometheus /etc/prometheus/prometheus.yml</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>With the configuration complete, we‚Äôre ready to test Prometheus by running it for the first time.
Step 4 ‚Äî Running Prometheus</p><p>Start up Prometheus as the prometheus user, providing the path to both the configuration file and the data directory.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">sudo -u prometheus /usr/local/bin/prometheus \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    --config.file /etc/prometheus/prometheus.yml \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    --storage.tsdb.path /var/lib/prometheus/ \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    --web.console.templates=/etc/prometheus/consoles \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    --web.console.libraries=/etc/prometheus/console_libraries</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The output contains information about Prometheus‚Äô loading progress, configuration file, and related services. It also confirms that Prometheus is listening on port 9090.</p><p>Output
level=info ts=2017-11-17T18:37:27.474530094Z caller=main.go:215 msg=&quot;Starting Prometheus&quot; version=&quot;(version=2.0.0, branch=HEAD, re
vision=0a74f98628a0463dddc90528220c94de5032d1a0)&quot;
level=info ts=2017-11-17T18:37:27.474758404Z caller=main.go:216 build_context=&quot;(go=go1.9.2, user=root@615b82cb36b6, date=20171108-
07:11:59)&quot;
level=info ts=2017-11-17T18:37:27.474883982Z caller=main.go:217 host_details=&quot;(Linux 4.4.0-98-generic #121-Ubuntu SMP Tue Oct 10 1
4:24:03 UTC 2017 x86_64 prometheus-update (none))&quot;
level=info ts=2017-11-17T18:37:27.483661837Z caller=web.go:380 component=web msg=&quot;Start listening for connections&quot; address=0.0.0.0
:9090
level=info ts=2017-11-17T18:37:27.489730138Z caller=main.go:314 msg=&quot;Starting TSDB&quot;
level=info ts=2017-11-17T18:37:27.516050288Z caller=targetmanager.go:71 component=&quot;target manager&quot; msg=&quot;Starting target manager...
&quot;
level=info ts=2017-11-17T18:37:27.537629169Z caller=main.go:326 msg=&quot;TSDB started&quot;
level=info ts=2017-11-17T18:37:27.537896721Z caller=main.go:394 msg=&quot;Loading configuration file&quot; filename=/etc/prometheus/promethe
us.yml
level=info ts=2017-11-17T18:37:27.53890004Z caller=main.go:371 msg=&quot;Server is ready to receive requests.&quot;</p><p>If you get an error message, double-check that you‚Äôve used YAML syntax in your configuration file and then follow the on-screen instructions to resolve the problem.</p><p>Now, halt Prometheus by pressing CTRL+C, and then open a new systemd service file.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">sudo nano /etc/systemd/system/prometheus.service</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The service file tells systemd to run Prometheus as the prometheus user, with the configuration file located in the /etc/prometheus/prometheus.yml directory and to store its data in the /var/lib/prometheus directory. (The details of systemd service files are beyond the scope of this tutorial, but you can learn more at Understanding Systemd Units and Unit Files.)</p><p>Copy the following content into the file:
Prometheus service file - /etc/systemd/system/prometheus.service</p><p>[Unit]
Description=Prometheus
Wants=network-online.target
After=network-online.target</p><p>[Service]
User=prometheus
Group=prometheus
Type=simple
ExecStart=/usr/local/bin/prometheus \
--config.file /etc/prometheus/prometheus.yml \
--storage.tsdb.path /var/lib/prometheus/ \
--web.console.templates=/etc/prometheus/consoles \
--web.console.libraries=/etc/prometheus/console_libraries</p><p>[Install]
WantedBy=multi-user.target</p><p>Finally, save the file and close your text editor.</p><p>To use the newly created service, reload systemd.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">sudo systemctl daemon-reload</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>You can now start Prometheus using the following command:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">sudo systemctl start prometheus</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>To make sure Prometheus is running, check the service‚Äôs status.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">sudo systemctl status prometheus</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The output tells you Prometheus‚Äô status, main process identifier (PID), memory use, and more.</p><p>If the service‚Äôs status isn‚Äôt active, follow the on-screen instructions and re-trace the preceding steps to resolve the problem before continuing the tutorial.</p><p>Output
‚óè prometheus.service - Prometheus
Loaded: loaded (/etc/systemd/system/prometheus.service; disabled; vendor preset: enabled)
Active: active (running) since Fri 2017-07-21 11:40:40 UTC; 3s ago
Main PID: 2104 (prometheus)
Tasks: 7
Memory: 13.8M
CPU: 470ms
CGroup: /system.slice/prometheus.service
...</p><p>When you‚Äôre ready to move on, press Q to quit the status command.</p><p>Lastly, enable the service to start on boot.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">sudo systemctl enable prometheus</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Now that Prometheus is up and running, we can install an additional exporter to generate metrics about our server‚Äôs resources.
Step 5 ‚Äî Downloading Node Exporter</p><p>To expand Prometheus beyond metrics about itself only, we‚Äôll install an additional exporter called Node Exporter. Node Exporter provides detailed information about the system, including CPU, disk, and memory usage.</p><p>First, download the current stable version of Node Exporter into your home directory. You can find the latest binaries along with their checksums on Prometheus‚Äô download page.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">cd ~</span></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -LO https://github.com/prometheus/node_exporter/releases/download/v0.15.1/node_exporter-0.15.1.linux-amd64.tar.gz</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Use the sha256sum command to generate a checksum of the downloaded file:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">sha256sum node_exporter-0.15.1.linux-amd64.tar.gz</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Verify the downloaded file‚Äôs integrity by comparing its checksum with the one on the download page.</p><p>Output
7ffb3773abb71dd2b2119c5f6a7a0dbca0cff34b24b2ced9e01d9897df61a127  node_exporter-0.15.1.linux-amd64.tar.gz</p><p>If the checksums don‚Äôt match, remove the downloaded file and repeat the preceding steps.</p><p>Now, unpack the downloaded archive.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">tar xvf node_exporter-0.15.1.linux-amd64.tar.gz</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>This will create a directory called node_exporter-0.15.1.linux-amd64 containing a binary file named node_exporter, a license, and a notice.</p><p>Copy the binary to the /usr/local/bin directory and set the user and group ownership to the node_exporter user that you created in Step 1.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">sudo cp node_exporter-0.15.1.linux-amd64/node_exporter /usr/local/bin</span></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo chown node_exporter:node_exporter /usr/local/bin/node_exporter</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Lastly, remove the leftover files from your home directory as they are no longer needed.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">rm -rf node_exporter-0.15.1.linux-amd64.tar.gz node_exporter-0.15.1.linux-amd64</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Now that you‚Äôve installed Node Exporter, let‚Äôs test it out by running it before creating a service file for it so that it starts on boot.
Step 6 ‚Äî Running Node Exporter</p><p>The steps for running Node Exporter are similar to those for running Prometheus itself. Start by creating the Systemd service file for Node Exporter.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">sudo nano /etc/systemd/system/node_exporter.service</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>This service file tells your system to run Node Exporter as the node_exporter user with the default set of collectors enabled.</p><p>Copy the following content into the service file:
Node Exporter service file - /etc/systemd/system/node_exporter.service</p><p>[Unit]
Description=Node Exporter
Wants=network-online.target
After=network-online.target</p><p>[Service]
User=node_exporter
Group=node_exporter
Type=simple
ExecStart=/usr/local/bin/node_exporter</p><p>[Install]
WantedBy=multi-user.target</p><p>Collectors define which metrics Node Exporter will generate. You can see Node Exporter‚Äôs complete list of collectors ‚Äî including which are enabled by default and which are deprecated ‚Äî in the Node Exporter README file.</p><p>If you ever need to override the default list of collectors, you can use the --collectors.enabled flag, like:
Node Exporter service file part - /etc/systemd/system/node_exporter.service</p><p>...
ExecStart=/usr/local/bin/node_exporter --collectors.enabled meminfo,loadavg,filesystem
...</p><p>The preceding example would tell Node Exporter to generate metrics using only the meminfo, loadavg, and filesystem collectors. You can limit the collectors to however few or many you need, but note that there are no blank spaces before or after the commas.</p><p>Save the file and close your text editor.</p><p>Finally, reload systemd to use the newly created service.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">sudo systemctl daemon-reload</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>You can now run Node Exporter using the following command:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">sudo systemctl start node_exporter</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Verify that Node Exporter‚Äôs running correctly with the status command.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">sudo systemctl status node_exporter</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Like before, this output tells you Node Exporter‚Äôs status, main process identifier (PID), memory usage, and more.</p><p>If the service‚Äôs status isn‚Äôt active, follow the on-screen messages and re-trace the preceding steps to resolve the problem before continuing.</p><p>Output
‚óè node_exporter.service - Node Exporter
Loaded: loaded (/etc/systemd/system/node_exporter.service; disabled; vendor preset: enabled)
Active: active (running) since Fri 2017-07-21 11:44:46 UTC; 5s ago
Main PID: 2161 (node_exporter)
Tasks: 3
Memory: 1.4M
CPU: 11ms
CGroup: /system.slice/node_exporter.service</p><p>Lastly, enable Node Exporter to start on boot.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">sudo systemctl enable node_exporter</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>With Node Exporter fully configured and running as expected, we‚Äôll tell Prometheus to start scraping the new metrics.
Step 7 ‚Äî Configuring Prometheus to Scrape Node Exporter</p><p>Because Prometheus only scrapes exporters which are defined in the scrape_configs portion of its configuration file, we‚Äôll need to add an entry for Node Exporter, just like we did for Prometheus itself.</p><p>Open the configuration file.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">sudo nano /etc/prometheus/prometheus.yml</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>At the end of the scrape_configs block, add a new entry called node_exporter.
Prometheus config file part 1 - /etc/prometheus/prometheus.yml</p><p>...</p><ul><li>job_name: &#x27;node_exporter&#x27;
scrape_interval: 5s
static_configs:<ul><li>targets: [&#x27;localhost:9100&#x27;]</li></ul></li></ul><p>Because this exporter is also running on the same server as Prometheus itself, we can use localhost instead of an IP address again along with Node Exporter‚Äôs default port, 9100.</p><p>Your whole configuration file should look like this:
Prometheus config file - /etc/prometheus/prometheus.yml</p><p>global:
scrape_interval: 15s</p><p>scrape_configs:</p><ul><li>job_name: &#x27;prometheus&#x27;
scrape_interval: 5s
static_configs:<ul><li>targets: [&#x27;localhost:9090&#x27;]</li></ul></li><li>job_name: &#x27;node_exporter&#x27;
scrape_interval: 5s
static_configs:<ul><li>targets: [&#x27;localhost:9100&#x27;]</li></ul></li></ul><p>Save the file and exit your text editor when you‚Äôre ready to continue.</p><p>Finally, restart Prometheus to put the changes into effect.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">sudo systemctl restart prometheus</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Once again, verify that everything is running correctly with the status command.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">sudo systemctl status prometheus</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>If the service‚Äôs status isn‚Äôt set to active, follow the on screen instructions and re-trace your previous steps before moving on.</p><p>Output
‚óè prometheus.service - Prometheus
Loaded: loaded (/etc/systemd/system/prometheus.service; disabled; vendor preset: enabled)
Active: active (running) since Fri 2017-07-21 11:46:39 UTC; 6s ago
Main PID: 2219 (prometheus)
Tasks: 6
Memory: 19.9M
CPU: 433ms
CGroup: /system.slice/prometheus.service</p><p>We now have Prometheus and Node Exporter installed, configured, and running. As a final precaution before connecting to the web interface, we‚Äôll enhance our installation‚Äôs security with basic HTTP authentication to ensure that unauthorized users can‚Äôt access our metrics.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://github.com/facebook/docusaurus/edit/master/website/docs/website-monitoring/website-monitoring.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_3DPF"></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/big-documentation/docs/website-monitoring/blackbox-exporter"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">¬´ Black Box Exporter</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/big-documentation/docs/website-monitoring/host-installer"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Prometheus Installer (Server Installer) ¬ª</div></a></div></nav></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/big-documentation/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/facebook/EmmettMartinBig" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2021 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/big-documentation/assets/js/runtime~main.70c760db.js"></script>
<script src="/big-documentation/assets/js/main.efc8312f.js"></script>
</body>
</html>